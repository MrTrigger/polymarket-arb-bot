# Strategy Configuration
# ======================
#
# Tunable strategy parameters for the trading bot.
# See config/bot.toml for operational settings.

# ============================================================================
# USER SETTINGS - Tune these for optimization
# ============================================================================

[tuning]
# Allocation ratios for directional signals (0.0 to 1.0)
# Higher = more aggressive on signal direction
strong_up_ratio = 0.80    # Strong UP: 80% YES, 20% NO (sweep optimal)
lean_up_ratio = 0.60      # Lean UP: 65% YES, 35% NO (sweep optimal)

# Confidence calculation params
# time_conf = time_conf_floor + (1 - time_conf_floor) * (1 - time_ratio)
# dist_conf = clamp(dist_conf_floor + dist_conf_per_atr * atr_multiple, floor, 1.0)
time_conf_floor = 0.30    # Min confidence from time at window start (sweep optimal)
dist_conf_floor = 0.20    # Min confidence for tiny moves (sweep optimal)
dist_conf_per_atr = 0.50  # Confidence gained per ATR of movement (sweep optimal)

# Edge requirement (quality filter)
# Trade if: EV = (confidence - price) >= min_edge
# min_edge = max_edge_factor * (time_remaining / window_duration)
# Higher value = stricter filter early in window, more selective trading
max_edge_factor = 0.30    # 30% EV required at window start, decays to 0 (sweep optimal)

[sweep]
# Parameter sweep configuration
# Run: cargo run -p poly-bot --release -- --mode backtest --sweep

# Base order size sweep (key parameter for trade frequency vs size tradeoff)
#base_order_sizes = [5, 10, 15]

# Always swept
#strong_ratios = [0.75, 0.80, 0.85]
#lean_ratios = [0.45, 0.50, 0.55]

# Edge factor sweep (quality filter)
edge_factors = [0.25, 0.30, 0.35]

# Confidence calculation params sweep (commented out by default)
#time_conf_floors = [0.25, 0.30, 0.35]
#dist_conf_floors = [0.15, 0.2, 0.25]
#dist_conf_per_atrs = [0.4, 0.45, 0.5]

results_file = "sweep_results.json"

# ============================================================================
# DEFAULTS - Rarely need to change these
# ============================================================================

[phases]
# Phase time boundaries (minutes)
early_boundary_min = 10
build_boundary_min = 5
core_boundary_min = 2

# Budget allocation per phase (must sum to 1.0)
early_budget = 0.15
build_budget = 0.25
core_budget = 0.30
final_budget = 0.30

[signals]
# Signal thresholds (basis points from strike)
strong_threshold_base_bps = 30
lean_threshold_base_bps = 20

# Time scaling factors
time_scale_30min = 1.0
time_scale_10min = 0.7
time_scale_3min = 0.5
time_scale_late = 0.3

[confidence]
# ATR normalization per asset
default_atr_btc = 20.0
default_atr_eth = 1.0
default_atr_sol = 0.15

# Distance confidence thresholds (ATR multiples)
dist_very_high_atr = 1.5
dist_high_atr = 1.0
dist_medium_atr = 0.75
dist_low_atr = 0.50
dist_very_low_atr = 0.25

# Time confidence thresholds (minutes)
time_very_high_min = 3
time_high_min = 6
time_medium_min = 9
time_low_min = 12

# Confidence boost for strong signals
dual_strong_boost = 1.2

[sizing]
trades_per_phase = 15
min_confidence_multiplier = 0.5
max_confidence_multiplier = 2.0
max_single_side_exposure = 0.80
min_hedge_ratio = 0.20
min_order_size = 1.0
